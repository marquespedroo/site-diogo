<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"="width=device-width, initial-scale=1.0">
    <title>Market Study - ImobiTools</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&family=Roboto:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/src/styles/dashboard.css">
    <style>
        .market-study-form {
            padding: var(--spacing-md) 0;
        }

        .samples-section {
            margin: var(--spacing-xl) 0;
        }

        .sample-list {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-md);
        }

        .sample-item {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr auto;
            gap: var(--spacing-md);
            padding: var(--spacing-md);
            background: var(--gray-100);
            border-radius: var(--radius-md);
            align-items: end;
        }

        .valuation-results {
            margin-top: var(--spacing-xl);
        }

        .valuation-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--spacing-lg);
            margin: var(--spacing-lg) 0;
        }

        .valuation-card {
            padding: var(--spacing-lg);
            background: var(--white);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-md);
            text-align: center;
            transition: transform 0.2s ease;
        }

        .valuation-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
        }

        .valuation-card h4 {
            font-size: 14px;
            color: var(--secondary);
            margin-bottom: var(--spacing-sm);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .valuation-card .price {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary);
            margin: var(--spacing-sm) 0;
        }

        .valuation-card .price-per-sqm {
            font-size: 14px;
            color: var(--gray-600);
        }

        .statistics-card {
            padding: var(--spacing-lg);
            background: var(--gray-100);
            border-radius: var(--radius-lg);
            margin: var(--spacing-lg) 0;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: var(--spacing-md);
            margin-top: var(--spacing-md);
        }

        .stat-item {
            text-align: center;
        }

        .stat-item .label {
            font-size: 12px;
            color: var(--gray-600);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .stat-item .value {
            font-size: 20px;
            font-weight: 700;
            color: var(--primary);
            margin-top: 4px;
        }
    </style>
</head>
<body>
    <!-- Sidebar Navigation (same as calculator) -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="logo-container">
                <svg class="logo-icon" width="32" height="32" viewBox="0 0 32 32" fill="none">
                    <circle cx="16" cy="16" r="15" fill="url(#argon-gradient)"/>
                    <rect x="7" y="8" width="4" height="12" rx="1" fill="white" opacity="0.9"/>
                    <rect x="13" y="10" width="4" height="10" rx="1" fill="white" opacity="0.8"/>
                    <rect x="19" y="6" width="4" height="14" rx="1" fill="white"/>
                    <defs>
                        <linearGradient id="argon-gradient" x1="0" y1="0" x2="32" y2="32">
                            <stop offset="0%" stop-color="#667eea"/>
                            <stop offset="100%" stop-color="#764ba2"/>
                        </linearGradient>
                    </defs>
                </svg>
                <h1 class="logo-text">ImobiTools</h1>
            </div>
        </div>

        <div class="sidebar-separator"></div>

        <nav class="sidebar-nav">
            <div class="nav-section">
                <a href="/index.html" class="nav-btn-secondary">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M2 2h5v5H2V2zm0 7h5v5H2V9zm7-7h5v5H9V2zm0 7h5v5H9V9z"/>
                    </svg>
                    Property Calculator
                </a>
                <a href="/market-study.html" class="nav-btn-secondary active">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M3 3h10a1 1 0 011 1v8a1 1 0 01-1 1H3a1 1 0 01-1-1V4a1 1 0 011-1z"/>
                    </svg>
                    Market Study
                </a>
                <a href="/projects-table.html" class="nav-btn-secondary">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M2 3h12a1 1 0 011 1v8a1 1 0 01-1 1H2a1 1 0 01-1-1V4a1 1 0 011-1z"/>
                    </svg>
                    Projects Table
                </a>
            </div>
        </nav>
    </aside>

    <main class="main-content" id="main-content">
        <header class="top-header">
            <div class="header-left">
                <div class="breadcrumb">
                    <svg width="14" height="14" viewBox="0 0 14 14" fill="currentColor">
                        <path d="M7 1L1 7h2v5h3V9h2v3h3V7h2L7 1z"/>
                    </svg>
                    <span class="breadcrumb-text">/ Tools / </span>
                    <span class="breadcrumb-current">Market Study</span>
                </div>
                <h2 class="page-title">Market Study</h2>
                <button class="menu-toggle" id="menu-toggle">
                    <svg width="21" height="16" viewBox="0 0 21 16" fill="currentColor">
                        <rect width="21" height="2" rx="1"/>
                        <rect y="7" width="21" height="2" rx="1"/>
                        <rect y="14" width="21" height="2" rx="1"/>
                    </svg>
                </button>
            </div>

            <div class="header-right">
                <div class="search-box">
                    <svg class="search-icon" width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M11.7 10.3l3.6 3.6-1.4 1.4-3.6-3.6a6 6 0 111.4-1.4zM6 10a4 4 0 100-8 4 4 0 000 8z"/>
                    </svg>
                    <input type="text" placeholder="Type here..." class="search-input">
                </div>

                <a href="#" class="sign-in-link">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M8 8a3 3 0 100-6 3 3 0 000 6zm0 2c-3 0-6 1.5-6 3v1h12v-1c0-1.5-3-3-6-3z"/>
                    </svg>
                    <span>Sign-in</span>
                </a>

                <button class="icon-btn" aria-label="Settings">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M8 10a2 2 0 100-4 2 2 0 000 4z"/>
                        <path d="M13.5 8c0-.3 0-.6-.1-.9l1.3-1-1-1.7-1.5.6c-.4-.3-.8-.6-1.3-.8L10.5 2h-2l-.4 1.6c-.5.2-.9.5-1.3.8l-1.5-.6-1 1.7 1.3 1c-.1.3-.1.6-.1.9s0 .6.1.9l-1.3 1 1 1.7 1.5-.6c.4.3.8.6 1.3.8l.4 1.6h2l.4-1.6c.5-.2.9-.5 1.3-.8l1.5.6 1-1.7-1.3-1c.1-.3.1-.6.1-.9z"/>
                    </svg>
                </button>

                <button class="icon-btn" aria-label="Notifications">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M8 2a4 4 0 00-4 4v3l-1 2h10l-1-2V6a4 4 0 00-4-4zm0 12a2 2 0 01-2-2h4a2 2 0 01-2 2z"/>
                    </svg>
                </button>
            </div>
        </header>

        <!-- Market Study Content -->
        <div class="content-grid">
            <!-- Subject Property Form -->
            <div class="card chart-card">
                <div class="card-header">
                    <h3>Subject Property</h3>
                    <p class="chart-subtitle">
                        <span class="trend-period">Enter the property details to be evaluated</span>
                    </p>
                </div>
                <div class="market-study-form">
                    <form id="marketStudyForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="subjectStreet">Street Address</label>
                                <input type="text" id="subjectStreet" name="subjectStreet" placeholder="Rua das Flores" required>
                            </div>
                            <div class="form-group">
                                <label for="subjectNumber">Number</label>
                                <input type="text" id="subjectNumber" name="subjectNumber" placeholder="123" required>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="subjectNeighborhood">Neighborhood</label>
                                <input type="text" id="subjectNeighborhood" name="subjectNeighborhood" placeholder="Centro" required>
                            </div>
                            <div class="form-group">
                                <label for="subjectCity">City</label>
                                <input type="text" id="subjectCity" name="subjectCity" placeholder="São Paulo" required>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="subjectState">State</label>
                                <select id="subjectState" name="subjectState" required>
                                    <option value="">Select state</option>
                                    <option value="SP">São Paulo</option>
                                    <option value="RJ">Rio de Janeiro</option>
                                    <option value="MG">Minas Gerais</option>
                                    <option value="PR">Paraná</option>
                                    <option value="SC">Santa Catarina</option>
                                    <option value="RS">Rio Grande do Sul</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="subjectArea">Area (m²)</label>
                                <input type="number" id="subjectArea" name="subjectArea" placeholder="85" min="1" step="0.01" required>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="subjectBedrooms">Bedrooms</label>
                                <input type="number" id="subjectBedrooms" name="subjectBedrooms" placeholder="2" min="0" required>
                            </div>
                            <div class="form-group">
                                <label for="subjectBathrooms">Bathrooms</label>
                                <input type="number" id="subjectBathrooms" name="subjectBathrooms" placeholder="1" min="0" required>
                            </div>
                            <div class="form-group">
                                <label for="subjectParking">Parking Spots</label>
                                <input type="number" id="subjectParking" name="subjectParking" placeholder="1" min="0" required>
                            </div>
                        </div>

                        <div class="samples-section">
                            <h4>Comparable Properties</h4>
                            <p class="section-subtitle">Add at least 3 comparable properties for valuation</p>

                            <div class="sample-list" id="samplesList"></div>
                            <button type="button" class="btn-add-installment" id="btnAddSample">+ Add Comparable Property</button>
                        </div>

                        <div class="form-actions">
                            <button type="submit" class="btn-primary-form">Calculate Valuation</button>
                            <button type="button" class="btn-secondary-form" id="btnResetMarketStudy">Reset Form</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Valuation Results -->
            <div class="card gradient-card" id="valuationResultsCard">
                <div class="gradient-content">
                    <div class="gradient-icon">
                        <svg width="64" height="64" viewBox="0 0 64 64" fill="white">
                            <path d="M32 8L8 20v20c0 15 10 28 24 32 14-4 24-17 24-32V20L32 8z" stroke="currentColor" stroke-width="3" fill="none"/>
                            <path d="M24 32l8 8 16-16" stroke="currentColor" stroke-width="3" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                    <h3 class="gradient-title" id="valuationTitle">Waiting for Analysis</h3>
                    <p class="gradient-description" id="valuationDescription">Fill out the form with property details and comparable samples to generate a professional market study.</p>
                    <div id="valuationDetails" class="valuation-results hidden">
                        <div class="valuation-grid" id="valuationGrid"></div>
                    </div>
                    <button class="btn-share hidden" id="btnGeneratePDF">Generate PDF Report</button>
                </div>
            </div>
        </div>

        <!-- Statistics Section -->
        <div class="card" id="statisticsCard" style="display: none;">
            <div class="card-header">
                <h3>Statistical Analysis (NBR 14653-2)</h3>
            </div>
            <div class="statistics-card">
                <div class="stats-grid" id="statsGrid"></div>
            </div>
        </div>

        <script type="module" src="/src/scripts/dashboard.js"></script>
        <script type="module" src="/src/scripts/market-study.js"></script>
    </main>
</body>
</html>
